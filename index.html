<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#6D28D9" />
  <meta name="color-scheme" content="dark light" />

  <title>T09 | Tawjihi Dashboard</title>
  <meta name="description" content="لوحة توجيهي الأردن 2009: جلسات، خطة ختمة، إحصائيات — تعمل أوفلاين." />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="style.css" />
  <script src="app.js" defer></script>
</head>

<body>
  <div class="app-shell">
    <!-- Top Bar -->
    <header class="topbar">
      <div class="topbar-left">
        <button class="icon-btn" id="btnMenu" aria-label="Menu">
          <i class="fa-solid fa-bars"></i>
        </button>

        <div class="brand">
          <div class="brand-badge">T09</div>
          <div class="brand-text">
            <div class="brand-title" data-i18n="appTitle">لوحة توجيهي 2009</div>
            <div class="brand-sub" data-i18n="appSub">جلسات • خطة ختمة • إحصائيات • Offline</div>
          </div>
        </div>
      </div>

      <div class="topbar-right">
        <div class="pill" role="group" aria-label="Language toggle">
          <button class="pill-btn" id="langAR" type="button">AR</button>
          <button class="pill-btn" id="langEN" type="button">EN</button>
        </div>

        <button class="icon-btn" id="btnMute" aria-label="Mute">
          <i class="fa-solid fa-volume-high"></i>
        </button>

        <a class="icon-btn" id="btnInstall" href="#" aria-label="Install" title="Install" hidden>
          <i class="fa-solid fa-download"></i>
        </a>
      </div>
    </header>

    <!-- Sidebar (Desktop) -->
    <aside class="sidebar" id="sidebar">
      <nav class="nav">
        <button class="nav-item is-active" data-tab="home">
          <i class="fa-solid fa-house"></i>
          <span data-i18n="tabHome">الرئيسية</span>
        </button>

        <button class="nav-item" data-tab="sessions">
          <i class="fa-solid fa-hourglass-half"></i>
          <span data-i18n="tabSessions">جلسات</span>
        </button>

        <button class="nav-item" data-tab="plan">
          <i class="fa-solid fa-calendar-check"></i>
          <span data-i18n="tabPlan">خطة الختمة</span>
        </button>

        <button class="nav-item" data-tab="stats">
          <i class="fa-solid fa-chart-line"></i>
          <span data-i18n="tabStats">الإحصائيات</span>
        </button>
      </nav>

      <div class="sidebar-footer">
        <div class="tiny" data-i18n="footerNote">حفظ تلقائي • Offline • تثبيت كتطبيق</div>
        <div class="tiny muted">GitHub Pages • PWA</div>
      </div>
    </aside>

    <!-- Drawer (Mobile) -->
    <div class="backdrop" id="drawerBackdrop" hidden></div>
    <aside class="drawer" id="drawer" hidden>
      <div class="drawer-head">
        <button class="icon-btn" id="btnCloseDrawer" aria-label="Close">
          <i class="fa-solid fa-xmark"></i>
        </button>
        <div class="drawer-title">T09</div>
      </div>

      <nav class="drawer-nav">
        <button class="nav-item is-active" data-tab="home">
          <i class="fa-solid fa-house"></i>
          <span data-i18n="tabHome">الرئيسية</span>
        </button>

        <button class="nav-item" data-tab="sessions">
          <i class="fa-solid fa-hourglass-half"></i>
          <span data-i18n="tabSessions">جلسات</span>
        </button>

        <button class="nav-item" data-tab="plan">
          <i class="fa-solid fa-calendar-check"></i>
          <span data-i18n="tabPlan">خطة الختمة</span>
        </button>

        <button class="nav-item" data-tab="stats">
          <i class="fa-solid fa-chart-line"></i>
          <span data-i18n="tabStats">الإحصائيات</span>
        </button>
      </nav>
    </aside>

    <!-- Main -->
    <main class="main">
      <!-- HOME -->
      <section class="tab is-active" id="tab-home">
        <div class="grid hero">
          <div class="card hero-card">
            <div class="hero-top">
              <div>
                <div class="kicker" data-i18n="homeKicker">جاهز تختم الفصل الثاني؟</div>
                <h1 class="h1" data-i18n="homeTitle">خطة توجيهي الأردن (2009) — ختمة منظمة</h1>
                <p class="sub" data-i18n="homeDesc">
                  اختار موعد الختمة (1 أيار أو 15 أيار) وخلي الخطة تتقسم أيامياً حسب وقتك.
                </p>
              </div>
              <div class="chip chip-purple">
                <i class="fa-solid fa-bolt"></i>
                <span data-i18n="homeChip">نمط وزاري + مراجعة أخطاء</span>
              </div>
            </div>

            <div class="today-focus">
              <div class="today-label" data-i18n="todayFocus">تركيز اليوم</div>
              <div class="today-text" id="todayFocusText">—</div>
              <div class="today-hint" data-i18n="todayHint">مأخوذ تلقائياً من خطة الختمة.</div>
            </div>

            <div class="actions">
              <button class="btn primary" data-go="plan">
                <i class="fa-solid fa-calendar-check"></i>
                <span data-i18n="goPlan">افتح خطة الختمة</span>
              </button>
              <button class="btn ghost" data-go="sessions">
                <i class="fa-solid fa-hourglass-half"></i>
                <span data-i18n="goSessions">ابدأ جلسة دراسة</span>
              </button>
              <button class="btn ghost" data-go="stats">
                <i class="fa-solid fa-chart-line"></i>
                <span data-i18n="goStats">شوف التقدم</span>
              </button>
            </div>
          </div>

          <div class="card side-card">
            <div class="side-title" data-i18n="quickTipsTitle">نصائح سريعة (توجيهي)</div>
            <ul class="bullets">
              <li data-i18n="tip1">بعد كل مهمة: 10–15 دقيقة “تحليل أخطاء”</li>
              <li data-i18n="tip2">خصص كل 3 أيام “مراجعة سريعة” قبل النوم</li>
              <li data-i18n="tip3">التزام بسيط يومياً أحسن من ضغط يومين وترك أسبوع</li>
            </ul>

            <div class="mini-stats">
              <div class="mini">
                <div class="mini-num" id="miniSessions">0</div>
                <div class="mini-label" data-i18n="miniSessions">جلسات</div>
              </div>
              <div class="mini">
                <div class="mini-num" id="miniMinutes">0</div>
                <div class="mini-label" data-i18n="miniMinutes">دقائق دراسة</div>
              </div>
              <div class="mini">
                <div class="mini-num" id="miniPlanPct">0%</div>
                <div class="mini-label" data-i18n="miniPlan">الخطة</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- SESSIONS -->
      <section class="tab" id="tab-sessions">
        <div class="tab-head">
          <div>
            <h2 class="h2" data-i18n="sessionsTitle">جلسات (بومودورو توجيهي)</h2>
            <p class="sub" data-i18n="sessionsDesc">جلسة دراسة + استراحة. احفظ إعداداتك وتابع تقدمك.</p>
          </div>
          <div class="tab-actions">
            <button class="btn ghost" id="btnResetStatsFromSessions">
              <i class="fa-solid fa-rotate"></i>
              <span data-i18n="resetStats">تصفير الإحصائيات</span>
            </button>
          </div>
        </div>

        <div class="grid two">
          <div class="card">
            <div class="timer-top">
              <div class="timer-mode" id="timerMode" data-i18n="modeStudy">دراسة</div>
              <div class="timer-meta">
                <span class="tag" id="cycleTag">1</span>
                <span class="muted" data-i18n="cycle">دورة</span>
              </div>
            </div>

            <div class="timer-wrap">
              <canvas id="ring" width="220" height="220"></canvas>
              <div class="timer-time" id="timeText">25:00</div>
              <div class="timer-hint" id="timerHint" data-i18n="hintStudy">ركز: هدف اليوم من الخطة</div>
            </div>

            <div class="timer-controls">
              <button class="btn primary" id="btnStart">
                <i class="fa-solid fa-play"></i>
                <span data-i18n="start">ابدأ</span>
              </button>
              <button class="btn ghost" id="btnPause">
                <i class="fa-solid fa-pause"></i>
                <span data-i18n="pause">إيقاف</span>
              </button>
              <button class="btn ghost" id="btnNext">
                <i class="fa-solid fa-forward-step"></i>
                <span data-i18n="next">التالي</span>
              </button>
              <button class="btn danger" id="btnReset">
                <i class="fa-solid fa-rotate-left"></i>
                <span data-i18n="reset">إعادة</span>
              </button>
            </div>

            <div class="row">
              <label class="toggle">
                <input type="checkbox" id="autoSwitch" />
                <span data-i18n="autoSwitch">تبديل تلقائي (دراسة/استراحة)</span>
              </label>
            </div>

            <div class="row">
              <label class="toggle">
                <input type="checkbox" id="soundOn" />
                <span data-i18n="soundOn">صوت تنبيه</span>
              </label>
            </div>
          </div>

          <div class="card">
            <div class="card-title" data-i18n="settings">الإعدادات</div>

            <div class="form-grid">
              <div class="field">
                <label data-i18n="studyMin">دقائق الدراسة</label>
                <input id="studyMin" type="number" min="10" max="90" step="1" />
                <div class="hint" data-i18n="studyHint">مقترح: 25–40 دقيقة حسب تركيزك</div>
              </div>

              <div class="field">
                <label data-i18n="breakMin">دقائق الاستراحة</label>
                <input id="breakMin" type="number" min="3" max="30" step="1" />
                <div class="hint" data-i18n="breakHint">مقترح: 5–10 دقائق</div>
              </div>
            </div>

            <button class="btn primary" id="btnSaveDurations">
              <i class="fa-solid fa-floppy-disk"></i>
              <span data-i18n="save">حفظ</span>
            </button>

            <hr class="sep" />

            <div class="card-title" data-i18n="sessionMetrics">مؤشرات</div>
            <div class="metric-grid">
              <div class="metric">
                <div class="metric-num" id="mStudySessions">0</div>
                <div class="metric-label" data-i18n="mStudySessions">جلسات دراسة</div>
              </div>
              <div class="metric">
                <div class="metric-num" id="mStudyMinutes">0</div>
                <div class="metric-label" data-i18n="mStudyMinutes">دقائق دراسة</div>
              </div>
              <div class="metric">
                <div class="metric-num" id="mBreaks">0</div>
                <div class="metric-label" data-i18n="mBreaks">استراحات</div>
              </div>
              <div class="metric">
                <div class="metric-num" id="mBreakMinutes">0</div>
                <div class="metric-label" data-i18n="mBreakMinutes">دقائق استراحة</div>
              </div>
            </div>

            <div class="note">
              <i class="fa-solid fa-circle-info"></i>
              <span data-i18n="noteLocal">كل شي محفوظ تلقائياً على جهازك (LocalStorage).</span>
            </div>
          </div>
        </div>
      </section>

      <!-- PLAN -->
      <section class="tab" id="tab-plan">
        <div class="tab-head">
          <div>
            <h2 class="h2" data-i18n="planTitle">خطة الختمة (حسب الورقة)</h2>
            <p class="sub" data-i18n="planDesc">
              اختار موعد الختمة وطريقة تقسيم المهام. كل يوم مهام واضحة + تفعيل “تم” للتتبع.
            </p>
          </div>
          <div class="tab-actions">
            <button class="btn ghost" id="btnCopyPlan">
              <i class="fa-solid fa-copy"></i>
              <span data-i18n="copyPlan">نسخ الخطة</span>
            </button>
            <button class="btn primary" id="btnRegeneratePlan">
              <i class="fa-solid fa-wand-magic-sparkles"></i>
              <span data-i18n="regenPlan">إعادة توليد</span>
            </button>
          </div>
        </div>

        <div class="grid two">
          <div class="card">
            <div class="card-title" data-i18n="planOptions">خيارات الخطة</div>

            <div class="option-row">
              <label class="label" data-i18n="targetDate">موعد الختمة</label>
              <div class="seg" role="group">
                <button class="seg-btn is-active" data-target="may1" id="targetMay1">
                  <span data-i18n="may1">1 أيار</span>
                </button>
                <button class="seg-btn" data-target="may15" id="targetMay15">
                  <span data-i18n="may15">15 أيار</span>
                </button>
              </div>
            </div>

            <div class="option-row">
              <label class="label" data-i18n="dailyMode">تقسيم اليوم</label>
              <div class="seg" role="group">
                <button class="seg-btn is-active" data-dailymode="two" id="dailyTwo">
                  <span data-i18n="twoTasks">مهمتين/يوم</span>
                </button>
                <button class="seg-btn" data-dailymode="four" id="dailyFour">
                  <span data-i18n="oneEach">مهمة من كل مادة</span>
                </button>
              </div>
            </div>

            <div class="option-row">
              <label class="toggle">
                <input type="checkbox" id="includeReviewDays" checked />
                <span data-i18n="reviewDays">أيام مراجعة/تحليل أخطاء أسبوعياً</span>
              </label>
            </div>

            <div class="option-row">
              <label class="toggle">
                <input type="checkbox" id="lightDay" checked />
                <span data-i18n="lightDay">يوم خفيف أسبوعياً (تخفيف ضغط)</span>
              </label>
            </div>

            <div class="plan-summary" id="planSummary">
              —
            </div>

            <div class="hint" data-i18n="planHint">
              ملاحظة: المحتوى هنا “مبني على مجموعات” من البنود الظاهرة بالورقة (وحدات/مراجعات/نمط وزاري).
            </div>
          </div>

          <div class="card">
            <div class="card-title" data-i18n="todayFromPlan">مهام اليوم من الخطة</div>
            <div class="today-box" id="todayTasks">
              <div class="muted" data-i18n="noPlanYet">اختار الخيارات واضغط “إعادة توليد”.</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-title" data-i18n="calendarTitle">تقسيم الأيام</div>
          <div class="calendar-tools">
            <input id="planSearch" class="search" type="search" placeholder="بحث..." />
            <div class="pill small">
              <span class="muted" data-i18n="planProgress">تقدم الخطة</span>
              <strong id="planProgressText">0%</strong>
            </div>
          </div>

          <div class="day-list" id="dayList"></div>
        </div>
      </section>

      <!-- STATS -->
      <section class="tab" id="tab-stats">
        <div class="tab-head">
          <div>
            <h2 class="h2" data-i18n="statsTitle">الإحصائيات والتقدم</h2>
            <p class="sub" data-i18n="statsDesc">جلساتك + تقدم الخطة + ستريك + أفضل يوم.</p>
          </div>
          <div class="tab-actions">
            <button class="btn danger" id="btnResetAll">
              <i class="fa-solid fa-trash"></i>
              <span data-i18n="resetAll">تصفير الكل</span>
            </button>
          </div>
        </div>

        <div class="grid three">
          <div class="card metric-card">
            <div class="metric-num" id="sStudySessions">0</div>
            <div class="metric-label" data-i18n="mStudySessions">جلسات دراسة</div>
          </div>
          <div class="card metric-card">
            <div class="metric-num" id="sStudyMinutes">0</div>
            <div class="metric-label" data-i18n="mStudyMinutes">دقائق دراسة</div>
          </div>
          <div class="card metric-card">
            <div class="metric-num" id="sPlanPct">0%</div>
            <div class="metric-label" data-i18n="planCompletion">نسبة إنجاز الخطة</div>
          </div>
        </div>

        <div class="grid two">
          <div class="card">
            <div class="card-title" data-i18n="streakTitle">الستريك</div>
            <div class="stat-row">
              <div class="stat-item">
                <div class="stat-num" id="streakNow">0</div>
                <div class="stat-label" data-i18n="currentStreak">الحالي</div>
              </div>
              <div class="stat-item">
                <div class="stat-num" id="bestDay">—</div>
                <div class="stat-label" data-i18n="bestDay">أفضل يوم</div>
              </div>
            </div>

            <div class="note">
              <i class="fa-solid fa-fire"></i>
              <span data-i18n="streakRule">اليوم محسوب إذا أنهيت ≥1 جلسة دراسة أو ≥1 مهمة من الخطة.</span>
            </div>
          </div>

          <div class="card">
            <div class="card-title" data-i18n="chartTitle">مخطط الدراسة للأسبوع</div>
            <canvas id="weekChart" width="800" height="320" class="chart"></canvas>
            <div class="hint" data-i18n="chartHint">يعرض دقائق الدراسة اليومية (آخر 7 أيام).</div>
          </div>
        </div>
      </section>
    </main>

    <!-- Bottom Nav (Mobile) -->
    <nav class="bottom-nav">
      <button class="bnav is-active" data-tab="home">
        <i class="fa-solid fa-house"></i>
        <span data-i18n="tabHome">الرئيسية</span>
      </button>
      <button class="bnav" data-tab="sessions">
        <i class="fa-solid fa-hourglass-half"></i>
        <span data-i18n="tabSessions">جلسات</span>
      </button>
      <button class="bnav" data-tab="plan">
        <i class="fa-solid fa-calendar-check"></i>
        <span data-i18n="tabPlan">خطة الختمة</span>
      </button>
      <button class="bnav" data-tab="stats">
        <i class="fa-solid fa-chart-line"></i>
        <span data-i18n="tabStats">الإحصائيات</span>
      </button>
    </nav>

    <!-- Toast -->
    <div class="toast" id="toast" hidden></div>
  </div>
</body>
</html>
